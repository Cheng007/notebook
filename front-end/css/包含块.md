# 包含块

[包含块](https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_display/Containing_block)（containing block）是 CSS 布局中一个重要的概念。对于盒子窗口，都会有如下四个区域：
- 内容区
- 内边距区
- 边框区
- 外边距区

包含块不一定都是他父元素的内容区。

## 包含块影响什么？

一个元素的一些属性，如`width` `height` `padding` `margin`，绝对定位元素的偏移值，当其值为百分比时，这些值都是通过元素的包含块来计算的。

## 怎么确定包含块？

确定一个元素的包含块的过程完全依赖于这个元素的 `position` 属性：

如果 `position` 属性为 `static`、`relative` 或 `sticky`，包含块可能由它的最近的祖先<b>块元素</b>（比如说 `inline-block`, `block` 或 `list-item` 元素）的内容区的边缘组成，也可能会建立格式化上下文 (比如说 a table container, flex container, grid container, 或者是 the block container 自身)。
如果 `position` 属性为 `absolute` ，包含块就是由它的最近的 `position` 的值不是 `static` （也就是值为`fixed`, `absolute`, `relative` 或 `sticky`）的祖先元素的内边距区的边缘组成。
如果 `position` 属性是 `fixed`，在连续媒体的情况下 (continuous media) 包含块是 viewport ,在分页媒体 (paged media) 下的情况下包含块是分页区域 (page area)。
如果 `position` 属性是 `absolute` 或 `fixed`，包含块也可能是由满足以下条件的最近父级元素的内边距区的边缘组成的：
`transform` 或 `perspective` 的值不是 `none`
`will-change` 的值是 `transform` 或 `perspective`
`filter` 的值不是 `none` 或 `will-change` 的值是 `filter`（只在 Firefox 下生效）。
`contain` 的值是 `layout`、`paint`、`strict` 或 `content`（例如：`contain: paint;`）
`backdrop-filter` 的值不是 `none`（例如：backdrop-filter: blur(10px);）

平时简单可以按下面来理解：

- 常规盒子或浮动盒子
父元素的内容盒（内容区）

- 绝对定位
最近定位祖先的填充盒（content + padding-left + padding-right）

- 固定定位
是否有变形祖先？
有：最近变形祖先的填充盒（content + padding-left + padding-right）
无：视口

## 怎么计算百分比值？

当某些属性被赋予一个百分比值时，它的计算值取决于这个元素的包含块。以这种方式工作的属性包括盒模型属性和偏移属性：
1. `height`、`top` 及 `bottom` 属性根据包含块的 `height` 计算百分比值。
2. `width`、`left`、`right`、`padding` 和 `margin` 属性根据包含块的 `width` 计算百分比值。
